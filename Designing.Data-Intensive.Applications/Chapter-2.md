# 第二章 数据模型和查询语言

数据模型可能是开发软件时最重要的部分，因为数据模型不仅会影响软件如何编写，还会影响我们如何考虑要解决的问题。

大部分应用都是通过将数据模型逐层堆叠来构建的。对于每一个数据模型层，关键问题是：如何用紧邻的较低层的模型表达当前层？比如：

- 应用软件开发者会将真实世界建模为对象和数据结构，API则是用来操作这些数据结构的。这些结构经常是为具体应用定制的。

- 在存储数据结构时，需要首先将其表达为通用的数据模型，比如JSON或者XML文档、关系型数据库中的表或者图模型。

- 数据库软件开发者会选择将JSON/XML/关系型/图数据存储到内存、硬盘或者网络上，从而使这些数据可以被查询、搜索、操作或者按照各种方式处理。

- 在更加底层的层中，硬件工程师会选择将字节数据存储在各种硬件中。

在复杂应用中，存在着更多的中间层，但是基本的思想也是相同的：每一层向更高层隐藏属于当前层的复杂性，通过提供更加简洁的数据模型。这种抽象使得不同团队的人在一起高效地合作。

存在不同种类的数据模型，每种数据模型都是基于其存储数据的使用方式来构建的。部分使用方式是简单的，而其他使用方式是不支持的；部分操作是处理速度快的，而另外一部分操作是处理速度慢的；有些数据转换方式是自然的，而另外一些数据转换方式是笨拙的。

由于数据模型对于使用者能做和不能做的事情，有着如此深刻的影响，选择合适的数据模型是十分重要的。

在本章中，我们将介绍一系列通用的、用于数据存储或者查询的数据模型。特别是，对关系模型、文档模型和一部分基于图的模型的比较。我们也会介绍多种查询语言，以及它们适用的场景。在第三章中，我们将讨论存储引擎是如何工作的，即这些数据模型是如何实现的。

## 关系模型vs文档模型

最广为人知的数据模型是，基于关系模型的SQL。数据被组织为**关系**（SQL中的表），每个关系是**元组**（SQL中的行）的无序集合。

关系模型是一种理论上的设想，当时有许多人质疑其能否高效地实现。然而，在80年代中期，关系型数据库管理系统（RDBMS）和SQL已经成为了存储数据和查询数据的最佳选择。

那时的其他数据库会要求应用开发人员去大量思考数据库中数据的内部表达方式。关系模型的目标是将这些实现细节隐藏在简洁的接口层之下。

### NoSQL的诞生

**NoSQL**被解释为**Not Only SQL**。NoSQL数据库出现的背后有着多种推动力：

- 对于关系型数据库很难实现的高度伸缩性的需要，包括更大的数据量或者更快的写入吞吐量。

- 对于免费、开源软件而不是商业数据库产品的偏好。

- 对于关系型数据库通常不支持的特殊查询操作的需要。

- 对于关系型模式限制的失望，以及对更加灵活、更具表达性的数据模型的需要。

不同的应用有着不同的要求，不同应用的最佳技术方案选择也是不同的。因此，在可以预见的将来，关系型数据库会继续与一系列不同的非关系型数据库共同使用，这种方式有时也被称为**混合持久化**。
